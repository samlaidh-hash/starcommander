<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Star Sea</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/ui.css">
    <link rel="stylesheet" href="css/hud.css">
    <link rel="stylesheet" href="css/menus.css">
</head>
<body>
    <!-- Main game canvas -->
    <canvas id="gameCanvas"></canvas>

    <!-- HUD Overlay -->
    <div id="hud">
        <!-- Tactical Panel (Top Left) -->
        <div id="tactical-panel">
            <div class="panel-header" id="player-ship-panel-title">Player Ship</div>

            <!-- Shields (Unified) -->
            <div class="system-group">
                <div class="system-label">Shields</div>
                <div class="shield-display">
                    <div class="shield-bar" id="shield-fore">
                        <span class="shield-label">SHIELD</span>
                        <div class="bar-fill" data-quadrant="fore"></div>
                    </div>
                    <div id="shield-status" style="color: #0f0; font-size: 9px; margin-top: 2px;">UP</div>
                </div>
            </div>

            <!-- Energy Blocks -->
            <div class="system-group" id="energy-blocks-group">
                <div class="system-label">Energy Blocks</div>
                <div id="energy-blocks-container"></div>
            </div>

            <!-- Throttle -->
            <div class="system-group">
                <div class="system-label">Throttle</div>
                <div id="throttle-display">0%</div>
                <div class="throttle-bar">
                    <div class="throttle-bar-fill" id="throttle-bar-fill"></div>
                </div>
            </div>

            <!-- Hull Integrity (DEPRECATED - kept for compatibility) -->
            <div class="system-group" style="display: none;">
                <div class="system-label">Hull Integrity</div>
                <div id="hull-status">
                    <div class="system-item" data-system="hull">HP: <span class="hp" id="ship-hp">100/100</span></div>
                </div>
            </div>

            <!-- Systems -->
            <div class="system-group">
                <div class="system-label">Systems</div>
                <div id="systems-status">
                    <div class="system-item" data-system="impulse">
                        <span class="system-name">Impulse</span>
                        <div class="system-hp-bar"><div class="hp-fill"></div></div>
                    </div>
                    <div class="system-item" data-system="warp">
                        <span class="system-name">Warp</span>
                        <div class="system-hp-bar"><div class="hp-fill"></div></div>
                    </div>
                    <div class="system-item" data-system="sensors">
                        <span class="system-name">Sensors</span>
                        <div class="system-hp-bar"><div class="hp-fill"></div></div>
                    </div>
                    <div class="system-item" data-system="cnc">
                        <span class="system-name">C&C</span>
                        <div class="system-hp-bar"><div class="hp-fill"></div></div>
                    </div>
                    <div class="system-item" data-system="bay">
                        <span class="system-name">Bay</span>
                        <div class="system-hp-bar"><div class="hp-fill"></div></div>
                    </div>
                    <div class="system-item" data-system="power">
                        <span class="system-name">Power</span>
                        <div class="system-hp-bar"><div class="hp-fill"></div></div>
                    </div>
                    <!-- Weapons -->
                    <div class="system-item" data-system="beam-forward">
                        <span class="system-name">FWD Beam</span>
                        <div class="system-hp-bar"><div class="hp-fill"></div></div>
                    </div>
                    <div class="system-item" data-system="beam-aft">
                        <span class="system-name">AFT Beam</span>
                        <div class="system-hp-bar"><div class="hp-fill"></div></div>
                    </div>
                    <div class="system-item" data-system="torpedo">
                        <span class="system-name">Torpedo</span>
                        <div class="system-hp-bar"><div class="hp-fill"></div></div>
                    </div>
                </div>
            </div>

            <!-- Consumables (Loadout) -->
            <div class="system-group" id="consumables-group">
                <div class="system-label">Consumables [F1-F6]</div>
                <div id="consumables-status">
                    <div class="consumable-item" data-consumable="extraTorpedoes">
                        <span class="consumable-name">[F1] Torpedoes</span>
                        <span class="consumable-count" id="consumable-torpedoes">0</span>
                    </div>
                    <div class="consumable-item" data-consumable="extraDecoys">
                        <span class="consumable-name">[F2] Decoys</span>
                        <span class="consumable-count" id="consumable-decoys">0</span>
                    </div>
                    <div class="consumable-item" data-consumable="extraMines">
                        <span class="consumable-name">[F3] Mines</span>
                        <span class="consumable-count" id="consumable-mines">0</span>
                    </div>
                    <div class="consumable-item" data-consumable="hullRepairKit">
                        <span class="consumable-name">[F4] Repair</span>
                        <span class="consumable-count" id="consumable-repair">0</span>
                    </div>
                    <div class="consumable-item" data-consumable="energyCells">
                        <span class="consumable-name">[F5] Energy</span>
                        <span class="consumable-count" id="consumable-energy">0</span>
                    </div>
                </div>
            </div>

            <!-- Inventory -->
            <div class="system-group">
                <div class="inventory-line">Decoys: <span id="decoy-count">6</span></div>
                <div class="inventory-line">Mines: <span id="mine-count">6</span></div>
                <div class="inventory-line">Captor: <span id="captor-mine-count">2</span></div>
                <div class="inventory-line">Phaser: <span id="phaser-mine-count">2</span></div>
                <div class="inventory-line">Transp: <span id="transporter-mine-count">2</span></div>
                <div class="inventory-line">Intercept: <span id="interceptor-count">6</span></div>
                <div class="inventory-line">Shuttles: <span id="shuttle-count">0</span>/<span id="shuttle-max">6</span></div>
                <div class="inventory-line">Fighters: <span id="fighter-count">0</span>/<span id="fighter-max">4</span></div>
                <div class="inventory-line">Bombers: <span id="bomber-count">0</span>/<span id="bomber-max">2</span></div>
                <div class="inventory-line">Bay: <span id="bay-space">0</span>/<span id="bay-max">8</span></div>
                <div class="inventory-line">Torp: <span id="torpedo-storage">16</span> [<span id="torpedo-type">STD</span>]</div>
            </div>

            <!-- Critical Messages -->
            <div id="critical-log">
                <div class="log-header">Critical Events</div>
                <div id="log-messages"></div>
            </div>

            <!-- Warp Drive -->
            <div class="system-group">
                <div class="system-label">Warp Drive</div>
                <div id="warp-charge-bar">
                    <div id="warp-charge-fill"></div>
                </div>
            </div>

            <!-- Boost Status -->
            <div class="system-group" id="boost-status-group" style="display: none;">
                <div class="system-label" id="boost-label">BOOST</div>
                <div id="boost-bar">
                    <div id="boost-fill"></div>
                </div>
            </div>

            <!-- Ping Status -->
            <div class="system-group" id="ping-status-group" style="display: none;">
                <div class="system-label" id="ping-label">PING</div>
                <div id="ping-bar">
                    <div id="ping-fill"></div>
                </div>
                <div id="ping-text" style="text-align: center; color: #00ffff; font-size: 12px; margin-top: 2px;"></div>
            </div>
        </div>

        <!-- Minimap (Top Right) -->
        <div id="minimap-container">
            <canvas id="minimap" width="200" height="200"></canvas>
        </div>

        <!-- Target Info Panel (Below Minimap) -->
        <div id="target-info-panel" style="display: none;">
            <div class="panel-header">Selected Target</div>
            <div id="target-name" class="target-field">-</div>
            <div id="target-shields" class="target-field">Shields: -</div>
            <div id="target-hull" class="target-field">Hull: -</div>
            <div id="target-distance" class="target-field">Distance: -</div>
        </div>

        <!-- Mission Objectives Panel (Right Side) -->
        <div id="objectives-panel">
            <div class="panel-header">Mission Objectives</div>
            <div id="objectives-display">
                <!-- Populated by JavaScript -->
            </div>
        </div>

        <!-- Targeting Reticle -->
        <div id="reticle"></div>

        <!-- Ship Tooltip -->
        <div id="ship-tooltip" style="display: none;">
            <div class="tooltip-header"></div>
            <div class="tooltip-shields">
                <div class="tooltip-shield-line"><span class="label">FWD:</span> <span class="value" data-shield="fore"></span></div>
                <div class="tooltip-shield-line"><span class="label">PRT:</span> <span class="value" data-shield="port"></span></div>
                <div class="tooltip-shield-line"><span class="label">STB:</span> <span class="value" data-shield="starboard"></span></div>
                <div class="tooltip-shield-line"><span class="label">AFT:</span> <span class="value" data-shield="aft"></span></div>
            </div>
            <div class="tooltip-systems"></div>
        </div>

        <!-- Speed Bar -->
        <div id="speed-bar-container">
            <div class="system-label">Speed</div>
            <div id="speed-bar">
                <div id="speed-bar-reverse"></div>
                <div id="speed-bar-forward"></div>
            </div>
        </div>

        <!-- Controls Panel (Bottom Right) -->
        <div id="controls-panel">
            <div class="panel-header">Controls</div>
            <div class="controls-section">
                <div class="control-category">Movement</div>
                <div class="control-line"><span class="key">W/A/S/D</span> Move Ship</div>
                <div class="control-line"><span class="key">X</span> Full Stop</div>
                <div class="control-line"><span class="key">Double-tap & Hold W</span> Tactical Warp</div>
            </div>
            <div class="controls-section">
                <div class="control-category">Weapons</div>
                <div class="control-line"><span class="key">LMB</span> Fire Beams</div>
                <div class="control-line"><span class="key">RMB</span> Fire Torpedo</div>
                <div class="control-line"><span class="key">R</span> Cycle Torp Type</div>
                <div class="control-line"><span class="key">F</span> Lock Target</div>
            </div>
            <div class="controls-section">
                <div class="control-category">Defenses</div>
                <div class="control-line"><span class="key">C</span> Deploy Decoy</div>
                <div class="control-line"><span class="key">M</span> Deploy Mine</div>
                <div class="control-line"><span class="key">Shift+M</span> Captor Mine</div>
                <div class="control-line"><span class="key">Alt+M</span> Phaser Mine</div>
                <div class="control-line"><span class="key">Ctrl+M</span> Transp Mine</div>
                <div class="control-line"><span class="key">I</span> Interceptor</div>
            </div>
            <div class="controls-section">
                <div class="control-category">Advanced</div>
                <div class="control-line"><span class="key">Q</span> Tractor Beam</div>
                <div class="control-line"><span class="key">T</span> Transporter</div>
                <div class="control-line"><span class="key">1-6</span> Shuttle Missions</div>
                <div class="control-line"><span class="key">7</span> Launch Fighter</div>
                <div class="control-line"><span class="key">8</span> Launch Bomber</div>
            </div>
            <div class="controls-section">
                <div class="control-category">Faction Abilities</div>
                <div class="control-line"><span class="key">G</span> Quantum Drive (Dhojan)</div>
                <div class="control-line"><span class="key">K</span> Cloak (Andromedan)</div>
                <div class="control-line"><span class="key">P</span> Phase Shift (Andromedan)</div>
            </div>
            <div class="controls-section">
                <div class="control-category">Systems</div>
                <div class="control-line"><span class="key">Space</span> Toggle Shields</div>
                <div class="control-line"><span class="key">V</span> Warp Out</div>
                <div class="control-line"><span class="key">ESC</span> Pause Menu</div>
            </div>
        </div>

        <!-- Keyboard Summary Panel (Right Side - Slides in/out) - HIDDEN: Keep green controls panel only -->
        <div id="keyboard-panel" class="keyboard-panel" style="display: none;">
            <!-- Sidebar toggle button (always visible) -->
            <div id="keyboard-panel-toggle" class="keyboard-panel-toggle" title="Show/Hide Keyboard Reference">
                <span class="toggle-icon">?</span>
            </div>

            <!-- Panel content (slides in from right) -->
            <div class="keyboard-panel-content">
                <div class="panel-header">Keyboard Reference</div>

                <!-- Movement -->
                <div class="controls-section">
                    <div class="control-category">Movement</div>
                    <div class="control-line"><span class="key">W</span> Thrust Forward</div>
                    <div class="control-line"><span class="key">S</span> Thrust Reverse</div>
                    <div class="control-line"><span class="key">A</span> Turn Left</div>
                    <div class="control-line"><span class="key">D</span> Turn Right</div>
                    <div class="control-line"><span class="key">X</span> Full Stop</div>
                    <div class="control-line"><span class="key">Double W/A/S/D</span> Boost</div>
                    <div class="control-line"><span class="key">Double-tap & Hold W</span> Tactical Warp (Fed/Scint/Trigon/Pirate)</div>
                </div>

                <!-- Weapons -->
                <div class="controls-section">
                    <div class="control-category">Weapons</div>
                    <div class="control-line"><span class="key">LMB Hold</span> Fire Beams</div>
                    <div class="control-line"><span class="key">RMB Hold</span> Charge/Fire Torpedo</div>
                    <div class="control-line"><span class="key">R</span> Cycle Torpedo Type</div>
                    <div class="control-line"><span class="key">F</span> Toggle Lock Target</div>
                    <div class="control-line"><span class="key">TAB</span> Cycle Target Selection</div>
                </div>

                <!-- Defenses -->
                <div class="controls-section">
                    <div class="control-category">Defenses</div>
                    <div class="control-line"><span class="key">C</span> Deploy Decoy</div>
                    <div class="control-line"><span class="key">M</span> Deploy Standard Mine</div>
                    <div class="control-line"><span class="key">Shift+M</span> Deploy Captor Mine</div>
                    <div class="control-line"><span class="key">Alt+M</span> Deploy Phaser Mine</div>
                    <div class="control-line"><span class="key">Ctrl+M</span> Deploy Transporter Mine</div>
                    <div class="control-line"><span class="key">I</span> Launch Interceptor</div>
                </div>

                <!-- Consumables -->
                <div class="controls-section">
                    <div class="control-category">Consumables</div>
                    <div class="control-line"><span class="key">1</span> Extra Torpedoes (+10)</div>
                    <div class="control-line"><span class="key">2</span> Extra Decoys (+3)</div>
                    <div class="control-line"><span class="key">3</span> Extra Mines (+3)</div>
                    <div class="control-line"><span class="key">4</span> Shield Boost (+20%)</div>
                    <div class="control-line"><span class="key">5</span> Hull Repair Kit (+50 HP)</div>
                    <div class="control-line"><span class="key">6</span> Energy Cells (+20% dmg)</div>
                </div>

                <!-- Advanced Systems -->
                <div class="controls-section">
                    <div class="control-category">Advanced Systems</div>
                    <div class="control-line"><span class="key">Q</span> Tractor Beam</div>
                    <div class="control-line"><span class="key">T</span> Transporter</div>
                    <div class="control-line"><span class="key">7</span> Launch Fighter</div>
                    <div class="control-line"><span class="key">8</span> Launch Bomber</div>
                    <div class="control-line"><span class="key">Space</span> Warp Out</div>
                </div>

                <!-- Faction Abilities -->
                <div class="controls-section">
                    <div class="control-category">Faction Abilities</div>
                    <div class="control-line"><span class="key">G</span> Quantum Drive (Dhojan)</div>
                    <div class="control-line"><span class="key">K</span> Toggle Cloak (Andromedan)</div>
                    <div class="control-line"><span class="key">P</span> Phase Shift (Andromedan)</div>
                </div>

                <!-- System Controls -->
                <div class="controls-section">
                    <div class="control-category">System Controls</div>
                    <div class="control-line"><span class="key">ESC</span> Pause Menu</div>
                    <div class="control-line"><span class="key">Mouse Wheel</span> Zoom In/Out</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Menu Screens -->
    <div id="main-menu" class="menu-screen">
        <h1>STAR SEA</h1>
        <div id="ship-selection-panel">
            <div class="panel-title">Player Ship</div>
            <label for="player-ship-select">Choose your ship:</label>
            <select id="player-ship-select"></select>
            <div id="player-ship-summary">
                <p class="summary-line" id="ship-summary-role"></p>
                <p class="summary-line" id="ship-summary-description"></p>
                <p class="summary-line" id="ship-summary-stats"></p>
                <p class="summary-line" id="ship-summary-torpedoes"></p>
                <p class="summary-line" id="ship-summary-special"></p>
            </div>
        </div>
        <div class="menu-buttons">
            <button id="btn-new-game">New Game</button>
            <button id="btn-load-game">Load Game</button>
            <button id="btn-library">Library</button>
            <button id="btn-options">Options</button>
        </div>
    </div>

    <div id="pause-menu" class="menu-screen hidden">
        <h2>PAUSED</h2>
        <div class="menu-buttons">
            <button id="btn-resume">Resume</button>
            <button id="btn-save">Save Game</button>
            <button id="btn-load">Load Game</button>
            <button id="btn-options-pause">Options</button>
            <button id="btn-main-menu">Main Menu</button>
        </div>
    </div>

    <!-- Mission Briefing Screen -->
    <div id="briefing-screen" class="menu-screen hidden">
        <div class="briefing-container">
            <div class="briefing-header">
                <h2 id="briefing-title">MISSION BRIEFING</h2>
                <div class="mission-info">
                    <span id="mission-sector">Sector: Unknown</span>
                    <span id="mission-number">Mission 1</span>
                </div>
            </div>

            <div class="briefing-content">
                <!-- Two-column layout: Mission info on left, Loadout on right -->
                <div class="briefing-columns">
                    <!-- Left Column: Mission Information -->
                    <div class="briefing-column-left">
                        <div class="briefing-mission-frame">
                            <div class="briefing-officer">
                                <div class="officer-portrait"></div>
                                <div id="briefing-officer-name">Admiral Chen</div>
                            </div>

                            <div class="briefing-text">
                                <h3 id="briefing-subtitle">Mission Title</h3>
                                <p id="briefing-description">
                                    Mission description goes here...
                                </p>
                            </div>

                            <div class="briefing-objectives">
                                <h3>MISSION OBJECTIVES</h3>
                                <ul id="objectives-list">
                                    <!-- Objectives populated by JavaScript -->
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Consumables Loadout -->
                    <div class="briefing-column-right">
                        <div id="loadout-selection" class="briefing-section">
                            <h3>Consumables Loadout</h3>
                            <div id="loadout-summary" class="loadout-summary">
                                <strong>Current Loadout:</strong> <span id="loadout-summary-text">None selected</span>
                            </div>
                            <div id="bay-capacity">
                                Bay Capacity: <span id="bay-used">0</span> / <span id="bay-max">10</span>
                            </div>
                            
                            <div class="default-loadout">
                                <h4>Default Equipment (Always Included):</h4>
                                <div class="default-items">
                                    <span>Shuttles: <span id="default-shuttles">2</span></span>
                                    <span>Fighters: <span id="default-fighters">0</span></span>
                                    <span>Mines: <span id="default-mines">1</span></span>
                                </div>
                            </div>

                            <div class="consumables-grid">
                    <div class="consumable-item" data-type="hullRepairKit">
                        <span class="consumable-name">Hull Repair Kit</span>
                        <div class="consumable-controls">
                            <button class="btn-minus">−</button>
                            <span class="consumable-count">0</span>
                            <button class="btn-plus">+</button>
                        </div>
                        <span class="consumable-cost">1 bay</span>
                    </div>

                    <div class="consumable-item" data-type="energyCells">
                        <span class="consumable-name">Energy Cells</span>
                        <div class="consumable-controls">
                            <button class="btn-minus">−</button>
                            <span class="consumable-count">0</span>
                            <button class="btn-plus">+</button>
                        </div>
                        <span class="consumable-cost">1 bay</span>
                    </div>

                    <div class="consumable-item" data-type="extraTorpedoes">
                        <span class="consumable-name">Extra Torpedoes</span>
                        <div class="consumable-controls">
                            <button class="btn-minus">−</button>
                            <span class="consumable-count">0</span>
                            <button class="btn-plus">+</button>
                        </div>
                        <span class="consumable-cost">1 bay</span>
                    </div>

                    <div class="consumable-item" data-type="extraDecoys">
                        <span class="consumable-name">Extra Decoys</span>
                        <div class="consumable-controls">
                            <button class="btn-minus">−</button>
                            <span class="consumable-count">0</span>
                            <button class="btn-plus">+</button>
                        </div>
                        <span class="consumable-cost">1 bay</span>
                    </div>

                    <div class="consumable-item" data-type="extraMines">
                        <span class="consumable-name">Extra Mines</span>
                        <div class="consumable-controls">
                            <button class="btn-minus">−</button>
                            <span class="consumable-count">0</span>
                            <button class="btn-plus">+</button>
                        </div>
                        <span class="consumable-cost">1 bay</span>
                    </div>

                    <div class="consumable-item" data-type="extraShuttles">
                        <span class="consumable-name">Extra Shuttles</span>
                        <div class="consumable-controls">
                            <button class="btn-minus">−</button>
                            <span class="consumable-count">0</span>
                            <button class="btn-plus">+</button>
                        </div>
                        <span class="consumable-cost">1 bay</span>
                    </div>

                    <div class="consumable-item" data-type="extraFighters">
                        <span class="consumable-name">Extra Fighters</span>
                        <div class="consumable-controls">
                            <button class="btn-minus">−</button>
                            <span class="consumable-count">0</span>
                            <button class="btn-plus">+</button>
                        </div>
                        <span class="consumable-cost">1 bay</span>
                    </div>

                    <div class="consumable-item" data-type="extraBombers">
                        <span class="consumable-name">Extra Bombers</span>
                        <div class="consumable-controls">
                            <button class="btn-minus">−</button>
                            <span class="consumable-count">0</span>
                            <button class="btn-plus">+</button>
                        </div>
                        <span class="consumable-cost">2 bay</span>
                    </div>

                    <div class="consumable-item" data-type="extraDrones">
                        <span class="consumable-name">Extra Drones</span>
                        <div class="consumable-controls">
                            <button class="btn-minus">−</button>
                            <span class="consumable-count">0</span>
                            <button class="btn-plus">+</button>
                        </div>
                        <span class="consumable-cost">1 bay</span>
                    </div>

                    <div class="consumable-item" data-type="extraProbes">
                        <span class="consumable-name">Extra Probes</span>
                        <div class="consumable-controls">
                            <button class="btn-minus">−</button>
                            <span class="consumable-count">0</span>
                            <button class="btn-plus">+</button>
                        </div>
                        <span class="consumable-cost">1 bay</span>
                    </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Buttons outside briefing container -->
        <div class="briefing-footer">
            <button id="btn-accept-mission" class="mission-btn">ACCEPT MISSION</button>
            <button id="btn-decline-mission" class="mission-btn secondary">BACK TO MAIN MENU</button>
        </div>
    </div>

    <!-- Mission Debriefing Screen -->
    <div id="debriefing-screen" class="menu-screen hidden">
        <div class="debriefing-container">
            <div class="debriefing-header">
                <h2 id="debriefing-result">MISSION COMPLETE</h2>
                <div id="debriefing-mission-title">Mission Title</div>
            </div>

            <div class="debriefing-content">
                <div class="debriefing-stats">
                    <h3>MISSION STATISTICS</h3>
                    <div class="stat-row">
                        <span class="stat-label">Mission Time:</span>
                        <span id="stat-time" class="stat-value">00:00</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Enemies Destroyed:</span>
                        <span id="stat-enemies" class="stat-value">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Hull Integrity:</span>
                        <span id="stat-hull" class="stat-value">100%</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Objectives:</span>
                        <span id="stat-objectives" class="stat-value">0/0</span>
                    </div>
                </div>

                <div class="debriefing-text">
                    <h3>MISSION REPORT</h3>
                    <p id="debriefing-description">
                        Debriefing text goes here...
                    </p>
                </div>

                <div class="debriefing-objectives">
                    <h3>OBJECTIVES COMPLETED</h3>
                    <ul id="debriefing-objectives-list">
                        <!-- Objectives populated by JavaScript -->
                    </ul>
                </div>
            </div>

            <div class="debriefing-footer">
                <button id="btn-next-mission" class="mission-btn">NEXT MISSION</button>
                <button id="btn-return-base" class="mission-btn secondary">RETURN TO BASE</button>
            </div>
        </div>
    </div>

    <!-- Library Screen -->
    <div id="library-screen" class="menu-screen hidden">
        <div class="library-container">
            <div class="library-header">
                <h2>FACTION LIBRARY</h2>
                <button id="btn-library-close" class="library-close-btn">×</button>
            </div>
            <div class="library-content">
                <div class="library-sidebar">
                    <div class="faction-tab active" data-faction="federation">FEDERATION</div>
                    <div class="faction-tab" data-faction="trigon">TRIGON</div>
                    <div class="faction-tab" data-faction="scintilian">SCINTILIAN</div>
                    <div class="faction-tab" data-faction="dhojan">DHOJAN</div>
                    <div class="faction-tab" data-faction="commonwealth">COMMONWEALTH</div>
                    <div class="faction-tab" data-faction="andromedan">ANDROMEDAN</div>
                    <div class="faction-tab" data-faction="pirate">PIRATE</div>
                </div>
                <div class="library-main">
                    <div id="library-faction-content"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Third-party Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/planck-js@0.3.31/dist/planck.min.js"></script>

    <!-- Core Engine -->
    <script src="js/config.js"></script>
    <script src="js/config/SystemDamageBoxes.js"></script>
    <script src="js/config/AudioConfig.js"></script>
    <script src="js/utils/MathUtils.js"></script>
    <script src="js/core/EventBus.js"></script>
    <script src="js/core/AssetManager.js"></script>
    <script src="js/core/InputManager.js"></script>
    <script src="js/core/Camera.js"></script>
    <script src="js/core/StateManager.js"></script>
    <script src="js/core/GameLoop.js"></script>
    <script src="js/core/ShipFactory.js"></script>
    
    <!-- Rendering (needed by HUD) -->
    <script src="js/rendering/UIRenderer.js"></script>
    
    <!-- UI (must load before Engine.js) -->
    <script src="js/ui/HUD.js"></script>
    <script src="js/ui/MissionUI.js"></script>
    
    <script src="js/core/Engine.js"></script>

    <!-- Physics -->
    <script src="js/physics/PhysicsWorld.js"></script>
    <script src="js/physics/CollisionHandler.js"></script>
    <script src="js/physics/GravityWell.js"></script>

    <!-- Components (must load BEFORE rendering for instanceof checks) -->
    <script src="js/components/Transform.js"></script>
    <script src="js/components/Physics.js"></script>

    <!-- Weapon Components (must load BEFORE ShipRenderer for instanceof checks) -->
    <script src="js/components/weapons/Weapon.js"></script>
    <script src="js/components/weapons/BeamWeapon.js"></script>
    <script src="js/components/weapons/ContinuousBeam.js"></script>
    <script src="js/components/weapons/PulseBeam.js"></script>
    <script src="js/components/weapons/StreakBeam.js"></script>
    <script src="js/components/weapons/TorpedoLauncher.js"></script>
    <script src="js/components/weapons/DualTorpedoLauncher.js"></script>
    <script src="js/components/weapons/Disruptor.js"></script>
    <script src="js/components/weapons/PlasmaTorpedo.js"></script>
    <script src="js/components/weapons/LaserBattery.js"></script>

    <!-- Shield & Systems Components -->
    <script src="js/components/Shield.js"></script>
    <script src="js/components/EnergySystem.js"></script>
    <script src="js/components/InternalSystems.js"></script>

    <!-- Rendering (loads AFTER weapon components so instanceof checks work) -->
    <script src="js/rendering/ShipRenderer.js"></script>
    <script src="js/rendering/Renderer.js"></script>
    <script src="js/rendering/EnvironmentRenderer.js"></script>
    <script src="js/rendering/ParticleSystem.js"></script>

    <!-- Systems -->
    <script src="js/systems/TargetingSystem.js"></script>
    <script src="js/systems/CrewSkillSystem.js"></script>
    <script src="js/systems/ConsumableSystem.js"></script>
    <script src="js/systems/AIController.js"></script>
    <script src="js/systems/TractorBeamSystem.js"></script>
    <script src="js/systems/PowerManagementSystem.js"></script>
    <script src="js/systems/BaySystem.js"></script>
    <script src="js/systems/TransporterSystem.js"></script>
    <script src="js/systems/PingSystem.js"></script>
    <script src="js/systems/BalanceSystem.js"></script>
    <script src="js/systems/TestingSystem.js"></script>
    <script src="js/data/Missions.js"></script>
    <script src="js/systems/MissionManager.js"></script>
    <script src="js/systems/SaveManager.js"></script>
    <script src="js/systems/ProgressionManager.js"></script>
    <script src="js/systems/AudioManager.js"></script>
    <script src="js/systems/LibrarySystem.js"></script>

    <!-- Entities -->
    <script src="js/entities/Entity.js"></script>
    <script src="js/entities/Projectile.js"></script>
    <script src="js/entities/Decoy.js"></script>
    <script src="js/entities/Mine.js"></script>
    <script src="js/entities/Ship.js"></script>
    <script src="js/entities/Asteroid.js"></script>
    <script src="js/entities/GravelCloud.js"></script>
    <script src="js/entities/Planet.js"></script>
    <script src="js/entities/Star.js"></script>
    <script src="js/entities/BlackHole.js"></script>
    <script src="js/entities/Nebula.js"></script>
    <script src="js/entities/Environmental.js"></script>
    <script src="js/entities/LaserProjectile.js"></script>
    <script src="js/entities/BeamProjectile.js"></script>
    <script src="js/entities/DisruptorBeam.js"></script>
    <script src="js/entities/LaserCannon.js"></script>
    <script src="js/entities/LaserBeam.js"></script>
    <script src="js/entities/PhaseBeam.js"></script>
    <script src="js/entities/Shuttle.js"></script>
    <script src="js/entities/Fighter.js"></script>
    <script src="js/entities/Bomber.js"></script>
    <script src="js/entities/Drone.js"></script>
    <script src="js/entities/Probe.js"></script>
    <script src="js/entities/HeavyTorpedo.js"></script>
    <script src="js/entities/LaserTorpedo.js"></script>
    <script src="js/entities/PhaseTorpedo.js"></script>
    <script src="js/entities/DisruptorPulse.js"></script>
    <script src="js/entities/PlasmaCannon.js"></script>
    <script src="js/entities/InterceptorMissile.js"></script>
    <script src="js/entities/CaptorMine.js"></script>
    <script src="js/entities/PhaserMine.js"></script>
    <script src="js/entities/TransporterMine.js"></script>
    <script src="js/entities/DhojanShip.js"></script>
    <script src="js/entities/AndromedanShip.js"></script>
    <script src="js/entities/CommonwealthShip.js"></script>
    <script src="js/entities/QuantumTorpedo.js"></script>
    <script src="js/entities/GravityTorpedo.js"></script>
    <script src="js/entities/MissionEntity.js"></script>
    <script src="js/entities/CivilianTransport.js"></script>
    <script src="js/entities/SpaceStation.js"></script>
    <script src="js/entities/Derelict.js"></script>

    <!-- Main Entry Point -->
    <script src="js/main.js"></script>
</body>
</html>


